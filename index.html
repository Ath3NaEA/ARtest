<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebAR Marker with Rear Camera</title>
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.2.0/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar/dist/mindar-aframe.min.js"></script>
</head>
<body>
  <a-scene mindar-image embedded>
    <a-assets>
      <video id="marker-video" src="your-video.mp4" loop></video>
    </a-assets>
    <a-camera position="0 0 0" look-controls></a-camera>
    <a-entity mindar-image-target="targetIndex: 0">
      <a-video src="#marker-video" width="2" height="1"></a-video>
    </a-entity>
  </a-scene>
  <script>
    // カメラデバイスを取得
    navigator.mediaDevices.enumerateDevices()
      .then((devices) => {
        const videoDevices = devices.filter(device => device.kind === 'videoinput');
        const rearCamera = videoDevices.find(device => device.label.toLowerCase().includes('back'));
        if (rearCamera) {
          navigator.mediaDevices.getUserMedia({
            video: { deviceId: rearCamera.deviceId }
          }).then((stream) => {
            console.log("リアカメラ取得成功:", rearCamera.label);
            // mindARにそのストリームを設定
            const videoElement = document.querySelector('#marker-video');
            videoElement.srcObject = stream;
          }).catch((error) => {
            console.error("リアカメラの起動に失敗:", error);
          });
        } else {
          console.error("リアカメラが見つかりません。デフォルトカメラを使用します。");
        }
      })
      .catch((error) => {
        console.error("デバイス情報の取得に失敗:", error);
      });
  </script>
</body>
</html>
